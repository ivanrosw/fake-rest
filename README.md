# Fake-Rest

Fake-Rest is used to create REST controllers for test your projects

### Getting started

Requirements for build
- Java 8+
- NPM

Build project
```
mvn clean install -DskipTests
```

Start application
```
cd <project-folder>/appbuild/target
java -jar FakeRest.jar
```
Open browser
```
http://localhost:8080
```

### Configuration
#### Controllers configuration
Controllers configuration contains parameters:
- URI - base uri with or without pattern
- Method - GET, HEAD, POST, PUT, PATCH, DELETE, OPTIONS, TRACE
- Function mode - CREATE, READ, UPDATE, DELETE, GROOVY
- Answer - need for init data in controller collection or specify static returning data
- GenerateId - flag for CREATE method. Should generate id or should use from body request
- GenerateIdPatterns - UUID, Sequence. It is used if generateId is true.
- DelayMs - time to delay answer

##### CRUD controllers
Controller works in 2 modes:

- Static - return specified data from 'answer' or request body that you send.
- Collection - services with collection, where you can make CRUD operations

Example static configuration:

| Function mode |Uri       |Real mapped Uri|Answer        | Function                                             |
|---------------|----------|-------------- |--------------|------------------------------------------------------|
| CRUD          |/test     |/test          |example       | Return 'example'                                     |
| CUD           |/test     |/test          |              | Return data from body or Bad Request if body is empty|
| R             |/test     |/test          |              | Return empty answer                                  |

For collection mode should configure uri with id in brackets '{', '}'. Id param can have any name.

Collection controllers can be specified with multiple ids.

You should use the same general base uri to connect collection controllers to each other

Example collection configuration:

| Function mode |Uri       |Real mapped Uri|Answer        | GenerateId | GenerateIdPatterns | Function                                                                  |
|---------------|----------|-------------- |--------------|------------|--------------------|---------------------------------------------------------------------------|
| READ          |/test/{id}|/test/         |{"id":"1"}    |            |                    | Add json to collection on init. Return all records                        |
|               |          |/test/{id}     |              |            |                    | Return record by id                                                       |
| CREATE        |/test/{id}|/test/         |{"id":"1"}    | false      |                    | Add json to collection on init. Create new records. Expect id in body json|
| CREATE        |/test/{id}|/test/         |              | true       |                    | Create new record. Id "id" will be generated by uuid                      |
| CREATE        |/test/{id}|/test/         |              | true       | id:SEQUENCE        | Create new record. Id "id" will be generated by sequence                  |
| UPDATE        |/test/{id}|/test/{id}     |              |            |                    | Update record by id. Rewrite id in body json from url value               |
| DELETE        |/test/{id}|/test/{id}     |              |            |                    | Delete record by id                                                       |

##### Groovy controller
You can configure groovy controller with your code.

You can use several variables in code:
- body - request body
- uri - uri of controller
- [controllerData](core/src/main/java/io/github/ivanrosw/fakerest/core/model/ControllerData.java) - collection with data for all collection controllers
- [jsonUtils](core/src/main/java/io/github/ivanrosw/fakerest/core/utils/JsonUtils.java) - utils to work with json

Groovy code should return [GroovyAnswer](core/src/main/java/io/github/ivanrosw/fakerest/core/model/GroovyAnswer.java)

You don't need to write "import..." of GroovyAnswer, ControllerData, JsonUtils, HttpStatus. It will be appended automatically.
But it's necessary if you want to import something else.

#### Configuration routers
Routers configuration contains parameters:
- URI - base uri with or without pattern
- Method - GET, HEAD, POST, PUT, PATCH, DELETE, OPTIONS, TRACE
- toUrl - uri or url what need to route request to

For example, if you configure method GET, router will consume GET and send request to toUrl using same method.

Example routers configuration:

|Method|Uri       |ToUrl    | Function                                               |
|------|----------|---------|--------------------------------------------------------|
|GET   |/test/{id}|/test    | Resend from collection controller to static controller |
